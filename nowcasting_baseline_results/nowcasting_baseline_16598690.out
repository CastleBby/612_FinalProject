================================================================================
NowcastingGPT Baseline - Maryland Weather Forecasting
================================================================================
Job ID: 16598690
Node: gpu-a5-1
Start time: Fri Dec  5 16:58:39 EST 2025

Python: /scratch/zt1/project/msml612-fa25/user/shhuang/useNowcastingGPT_env/bin/python
PyTorch version: 2.9.1+cu128
CUDA available: True

================================================================================
Stage 1: Data Download & Formatting
================================================================================
================================================================================
NowcastingGPT Data Downloader - Maryland Weather Data
================================================================================
Random seed: 202511

Configuration loaded from config.yaml
  Locations: 5
  Date range: 2000-01-01 to 2024-12-31
  Variables: ['temperature_2m', 'relative_humidity_2m', 'precipitation', 'pressure_msl', 'wind_speed_10m']

Starting data download from Open-Meteo API...
(This may take several minutes depending on date range)

Downloading data for Baltimore (39.29, -76.61)...
  Date range: 2000-01-01 to 2024-12-31
  Downloaded 219168 hours of data
Downloading data for Annapolis (38.98, -76.49)...
  Date range: 2000-01-01 to 2024-12-31
  Downloaded 219168 hours of data
Downloading data for Cumberland (39.62, -78.76)...
  Date range: 2000-01-01 to 2024-12-31
  Error downloading data: 429 Client Error: Too Many Requests for url: https://archive-api.open-meteo.com/v1/archive?latitude=39.62&longitude=-78.76&start_date=2000-01-01&end_date=2024-12-31&hourly=temperature_2m%2Crelative_humidity_2m%2Cprecipitation%2Cpressure_msl%2Cwind_speed_10m&timezone=America%2FNew_York
Downloading data for Ocean City (38.34, -75.08)...
  Date range: 2000-01-01 to 2024-12-31
  Error downloading data: 429 Client Error: Too Many Requests for url: https://archive-api.open-meteo.com/v1/archive?latitude=38.34&longitude=-75.08&start_date=2000-01-01&end_date=2024-12-31&hourly=temperature_2m%2Crelative_humidity_2m%2Cprecipitation%2Cpressure_msl%2Cwind_speed_10m&timezone=America%2FNew_York
Downloading data for Hagerstown (39.64, -77.72)...
  Date range: 2000-01-01 to 2024-12-31
  Error downloading data: 429 Client Error: Too Many Requests for url: https://archive-api.open-meteo.com/v1/archive?latitude=39.64&longitude=-77.72&start_date=2000-01-01&end_date=2024-12-31&hourly=temperature_2m%2Crelative_humidity_2m%2Cprecipitation%2Cpressure_msl%2Cwind_speed_10m&timezone=America%2FNew_York

Total data downloaded: 438336 records across 2 locations

================================================================================
DATA QUALITY CHECK
================================================================================
✓ No data quality issues detected
================================================================================

✓ Raw data saved to: nowcasting_gpt_data/raw_weather_data.csv
✓ Raw data saved to: nowcasting_gpt_data/raw_weather_data.pkl
✓ Metadata saved to: nowcasting_gpt_data/metadata.json

================================================================================
DATA SUMMARY
================================================================================
Total records: 438,336
Date range: 2000-01-01 00:00:00 to 2024-12-31 23:00:00
Locations: 2

Records per location:
location
Annapolis    219168
Baltimore    219168
dtype: int64

Precipitation statistics (mm/h):
              count      mean       std  min  25%  50%  75%   max
location                                                         
Annapolis  219168.0  0.145004  0.642976  0.0  0.0  0.0  0.0  48.3
Baltimore  219168.0  0.146203  0.646162  0.0  0.0  0.0  0.0  53.5

Missing values:
time                    0
temperature_2m          0
relative_humidity_2m    0
precipitation           0
pressure_msl            0
wind_speed_10m          0
location                0
latitude                0
longitude               0
dtype: int64
================================================================================

✅ Data download complete!

Next steps:
  1. Run: python nowcasting_gpt_data_formatter.py
  2. Then: sbatch nowcasting_gpt_pipeline.sbatch
================================================================================
NowcastingGPT Data Formatter
================================================================================
Random seed: 202511

Loading raw data from: nowcasting_gpt_data/raw_weather_data.pkl
Loaded 438,336 records

================================================================================
FORMATTING DATA TO NOWCASTINGGPT FORMAT
================================================================================
Split ratios: Train=70.0%, Val=15.0%, Test=15.0%

Processing Baltimore...

Temporal split:
  Training:   153,417 records (2000-01-01 00:00:00 to 2017-07-02 08:00:00)
  Validation: 32,875 records (2017-07-02 09:00:00 to 2021-04-02 03:00:00)
  Test:       32,876 records (2021-04-02 04:00:00 to 2024-12-31 23:00:00)
  ✓ Baltimore (train): 153,417 records → nowcasting_gpt_data/formatted_csv/training_Baltimore.csv
    Sample (first 3 rows):
      200001010000,0.0
      200001010100,0.0
      200001010200,0.0
  ✓ Baltimore (val): 32,875 records → nowcasting_gpt_data/formatted_csv/validation_Baltimore.csv
    Sample (first 3 rows):
      201707020900,0.0
      201707021000,0.0
      201707021100,0.0
  ✓ Baltimore (test): 32,876 records → nowcasting_gpt_data/formatted_csv/testing_Baltimore.csv
    Sample (first 3 rows):
      202104020400,0.0
      202104020500,0.0
      202104020600,0.0

Processing Annapolis...

Temporal split:
  Training:   153,417 records (2000-01-01 00:00:00 to 2017-07-02 08:00:00)
  Validation: 32,875 records (2017-07-02 09:00:00 to 2021-04-02 03:00:00)
  Test:       32,876 records (2021-04-02 04:00:00 to 2024-12-31 23:00:00)
  ✓ Annapolis (train): 153,417 records → nowcasting_gpt_data/formatted_csv/training_Annapolis.csv
    Sample (first 3 rows):
      200001010000,0.0
      200001010100,0.0
      200001010200,0.0
  ✓ Annapolis (val): 32,875 records → nowcasting_gpt_data/formatted_csv/validation_Annapolis.csv
    Sample (first 3 rows):
      201707020900,0.0
      201707021000,0.1
      201707021100,0.1
  ✓ Annapolis (test): 32,876 records → nowcasting_gpt_data/formatted_csv/testing_Annapolis.csv
    Sample (first 3 rows):
      202104020400,0.0
      202104020500,0.0
      202104020600,0.0

Processing Cumberland...
  ⚠️  No data for Cumberland, skipping
Processing Ocean City...
  ⚠️  No data for Ocean City, skipping
Processing Hagerstown...
  ⚠️  No data for Hagerstown, skipping
Creating combined CSVs (all locations)...
  ✓ Combined training: 306,834 records
  ✓ Combined validation: 65,750 records
  ✓ Combined test: 65,752 records

✓ Metadata saved to: nowcasting_gpt_data/formatted_csv/format_metadata.json

================================================================================
FORMATTING COMPLETE
================================================================================
Output directory: nowcasting_gpt_data/formatted_csv/

Files created:
  - training_{location}.csv (per location)
  - validation_{location}.csv (per location)
  - testing_{location}.csv (per location)
  - training_AllLocations.csv (combined)
  - validation_AllLocations.csv (combined)
  - testing_AllLocations.csv (combined)

Precipitation statistics (training set):
  Mean: 0.1296 mm/h
  Std:  0.5371 mm/h
  Max:  15.2000 mm/h
  Rain events (>0.1mm): 12.17%
================================================================================

✅ Data formatting complete!

Next steps:
  1. Review formatted CSV files in nowcasting_gpt_data/formatted_csv/
  2. Run: sbatch nowcasting_gpt_pipeline.sbatch

================================================================================
Stage 2: Training NowcastingGPT Baseline
================================================================================
================================================================================
NowcastingGPT Baseline Training
================================================================================
Random seed: 202511

Device: cuda
GPU: Tesla V100-SXM2-32GB

Configuration:
  Observation time: 24 hours
  Prediction time: 1 hour
  Batch size: 64
  Epochs: 100
  Learning rate: 0.0001

Loading data...
Loading data from: nowcasting_gpt_data/formatted_csv/training_AllLocations.csv
  Loaded 306834 hours
  Created 306810 sequences (obs=24h, pred=1h)
Training DataLoader created: 306810 sequences, batch_size=64
Loading data from: nowcasting_gpt_data/formatted_csv/validation_AllLocations.csv
  Loaded 65750 hours
  Created 65726 sequences (obs=24h, pred=1h)
Validation DataLoader created: 65726 sequences
Training sequences: 306,810
Validation sequences: 65,726

Creating model...
Model parameters: 0.80M

Starting training...

Epoch   1/100 | Train Loss: 0.086024 | Val Loss: 0.428389 | LR: 0.000100
  ✓ Saved best model (val_loss=0.428389)
Epoch   2/100 | Train Loss: 0.078212 | Val Loss: 0.424528 | LR: 0.000100
  ✓ Saved best model (val_loss=0.424528)
Epoch   3/100 | Train Loss: 0.075988 | Val Loss: 0.423253 | LR: 0.000100
  ✓ Saved best model (val_loss=0.423253)
Epoch   4/100 | Train Loss: 0.075496 | Val Loss: 0.438123 | LR: 0.000100
Epoch   5/100 | Train Loss: 0.074604 | Val Loss: 0.424508 | LR: 0.000099
Epoch   6/100 | Train Loss: 0.073043 | Val Loss: 0.422543 | LR: 0.000099
  ✓ Saved best model (val_loss=0.422543)
Epoch   7/100 | Train Loss: 0.072243 | Val Loss: 0.426862 | LR: 0.000099
Epoch   8/100 | Train Loss: 0.072493 | Val Loss: 0.417346 | LR: 0.000098
  ✓ Saved best model (val_loss=0.417346)
Epoch   9/100 | Train Loss: 0.070963 | Val Loss: 0.426254 | LR: 0.000098
Epoch  10/100 | Train Loss: 0.071573 | Val Loss: 0.421759 | LR: 0.000098
Epoch  11/100 | Train Loss: 0.071979 | Val Loss: 0.436011 | LR: 0.000097
Epoch  12/100 | Train Loss: 0.071321 | Val Loss: 0.431297 | LR: 0.000096
Epoch  13/100 | Train Loss: 0.071195 | Val Loss: 0.428421 | LR: 0.000096
Epoch  14/100 | Train Loss: 0.070441 | Val Loss: 0.416539 | LR: 0.000095
  ✓ Saved best model (val_loss=0.416539)
Epoch  15/100 | Train Loss: 0.069768 | Val Loss: 0.424894 | LR: 0.000095
Epoch  16/100 | Train Loss: 0.070089 | Val Loss: 0.421628 | LR: 0.000094
Epoch  17/100 | Train Loss: 0.069279 | Val Loss: 0.430534 | LR: 0.000093
Epoch  18/100 | Train Loss: 0.069937 | Val Loss: 0.420917 | LR: 0.000092
Epoch  19/100 | Train Loss: 0.069180 | Val Loss: 0.435942 | LR: 0.000091
Epoch  20/100 | Train Loss: 0.069665 | Val Loss: 0.431182 | LR: 0.000090
Epoch  21/100 | Train Loss: 0.069793 | Val Loss: 0.421181 | LR: 0.000090
Epoch  22/100 | Train Loss: 0.068952 | Val Loss: 0.428133 | LR: 0.000089
Epoch  23/100 | Train Loss: 0.069171 | Val Loss: 0.423979 | LR: 0.000088
Epoch  24/100 | Train Loss: 0.069088 | Val Loss: 0.425819 | LR: 0.000086
Epoch  25/100 | Train Loss: 0.068405 | Val Loss: 0.429043 | LR: 0.000085
Epoch  26/100 | Train Loss: 0.068275 | Val Loss: 0.428194 | LR: 0.000084
Epoch  27/100 | Train Loss: 0.068197 | Val Loss: 0.430652 | LR: 0.000083
Epoch  28/100 | Train Loss: 0.068190 | Val Loss: 0.427475 | LR: 0.000082
Epoch  29/100 | Train Loss: 0.068067 | Val Loss: 0.420214 | LR: 0.000081

Early stopping at epoch 29

================================================================================
Training Complete!
================================================================================
Best validation loss: 0.416539
Model saved to: best_baseline_model.pth
Training log: train_baseline.log
================================================================================

================================================================================
Stage 3: Evaluation & Metrics
================================================================================
================================================================================
NowcastingGPT Baseline Evaluation
================================================================================

Device: cuda

Loading model from: best_baseline_model.pth
Loaded model from epoch 14
Validation loss: 0.416539

Loading test data...
Loading data from: nowcasting_gpt_data/formatted_csv/testing_AllLocations.csv
  Loaded 65752 hours
  Created 65728 sequences (obs=24h, pred=1h)
Testing DataLoader created: 65728 sequences
Test sequences: 65,728

Running inference...
Total predictions: 65,728

================================================================================
Computing metrics...
================================================================================

================================================================================
=== NOWCASTINGGPT BASELINE RESULTS ===
================================================================================
RMSE : 0.6063 mm/h
MAE  : 0.1336 mm/h
CSI  : 0.5596
POD  : 0.8480
FAR  : 0.3780
Extreme POD: 0.8320

================================================================================
=== PERSISTENCE BASELINE ===
================================================================================
RMSE : 0.7423
MAE  : 0.1505
CSI  : 0.5561
POD  : 0.7147
FAR  : 0.2853
Extreme POD: 0.7017

================================================================================
=== IMPROVEMENT OVER BASELINE ===
================================================================================
RMSE :  -18.3%
MAE  :  -11.2%
CSI  :   +0.6%
POD  :  +18.6%
FAR  :  +32.5%
Extreme POD:  +18.6%
================================================================================


================================================================================
Stage 4: Generate Plots
================================================================================
================================================================================
Generating Training Visualizations
================================================================================

Creating plots...
✓ Saved: nowcasting_baseline_results/training_history.jpg
✓ Saved: nowcasting_baseline_results/loss_convergence.jpg

================================================================================
Visualization Complete!
================================================================================
Generated files:
  - nowcasting_baseline_results/training_history.jpg
  - nowcasting_baseline_results/loss_convergence.jpg
================================================================================

================================================================================
Pipeline Complete!
================================================================================
Output files:
  - nowcasting_baseline_results/metrics_table.txt
  - nowcasting_baseline_results/training_history.jpg
  - nowcasting_baseline_results/loss_convergence.jpg
  - best_baseline_model.pth

End time: Fri Dec  5 17:23:00 EST 2025
================================================================================
